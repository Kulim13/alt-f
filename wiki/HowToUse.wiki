#summary How to Use.

{{{

To use Alt-F you can use its administering web pages, directing a
web browser to the box default IP.

When booting, and to assign itself an IP, Alt-F tries to first use a IP supplied
through the kernel command line; if it is not supplied, it then tries
to use its own flashed settings; if unsuccessful it then tries to use the vendors
firmware flash defaults; if unsuccessful it then tries to requests a IP
from a DHCP server and finally tries to find an unassigned IP in the
192.168.1.254 to 192.168.1.240 range.

In detail, when Alt-F boots, it search:
0-For a kernel command line supplied name and IP (the default when using the
	 supplied fun_plug script)
1-If not found, it will search for its own settings in flash, and use them;
	you should do a "Save Settings" from the web page when you made any
	change that you want to preserve across reboots. Alt-F and the vendors
	defaults can coexist in flash while there is space available;
2-If not found, it will use one of the vendors default file, and use the IP
	specified there (if the box was *not* using DHCP);
3-If not found, it will try to use DHCP, you can consult your router web page
	to find what IP was assigned;
4-As a last resort, if no DHCP server is available, Alt-F will use the first
	free IP in the 192.168.1.254 until 192.168.1.240 range.

So, when booting using the fun_plug script, your box it will have the same IP,
and name as before.

If booting after flashing Alt-F, and if your box was setup with a fixed IP
in the vendors firmware, it will also have the same IP and name as before.
If your box was using DHCP in the vendors firmware, then it might have a different
IP under Alt-F, and you must go to the DHCP server web page (usually your router)
and find the assigned client IP. Do this before trying Alt-F, to be sure that you
know how to do it.
In the "worst" scenario, the box IP will be 192.168.1.240, but this is
very unlikely.

The easiest and recommended way for a server is for you to setup first the box
with a fixed IP using the vendors firmware. This will be the IP used by Alt-F.

To login in the web pages, you have to setup a new (volatile) password,
and "root" password will be the same.

You can then login using telnet or ssh and change the root password
using the "passwd" command. Note that if you later change the password
using the web page, than the root password will also be changed, so the
recommend procedure is to first set up a web password and then login
using telnet or ssh and change the root password.

The pages were tested with firefox, if you are using another browser and
find that something is not OK, try first with firefox and than report
back or, preferably, send a patch.

With the web pages, which are very crude and rude, you can do most of
the administrative tasks. One of the most likely causes for failures in
the web pages are spaces in filenames and browser caching. Please send a
report and a patch.

If you have a serial port, you can see the boot log and you are automaticaly
logged in, no password is asked.
Use the "passwd" command to set a new (volatile) root password.

The first time that you use the web pages or change the password, you
will be guided through a small set of pages, being prompted for a few
configuration details. In the end, you should flash the settings.  The
vendor flashed settings are only lost if you deliberately clear them.
However, they use almost all available flash space, so when trying to
save Alt-F settings you can see an error message.

To flash the settings in the cli (command line "interface"), use the
command "loadsave_settings". If you don't save settings, on each reboot
a new RSA/DSA key pair is generated for dropbear usage, and your ssh
client will complain.

After you save the settings in flash, Alt-F will use them on the next reboot,
so if you have setup a new IP in the host page, be sure that you write it down.

When a new disk is detected, either internal or USB connected, either at
boot or by hot-plugging,  Alt-F will first check and if necessary fix all
its filesystems, either if they are "dirty" or if "it's time" to do it.
A filesystem is dirty if the box was not properly shutdown or rebooted,
that is what happens with the vendor's firmware.

Thus, on its first boot, Alt-F will find all filesystems dirty and will
do a lengthly check/fix -- this can tens of minutes on very large disks
(12 minutes on an 88% full 230GB disk). During the check/fix, the led of
the disk which is being checked will flash, and the power led will flash
with an "heartbeat" rhythm. On poweroff or reboot, Alt-F will properly
unmount the disks, so the check/fix step will not happen at the second
and subsequent reboots. However, a check/fix is done every M mounts or
after D days since the last check. In the web status page, you are
warned that is time for you to start a filesystem check, in order to
avoid the lengthly check at the next boot.

After checking/fixing, Alt-F will mount all the disks filesystems in
the directory /mnt/<name>, where <name> can be either the disk partition
name, as in /mnt/sda3, or a filesystem label, such as /mnt/Backups.

If during the check/fix step the partition was dirty and could not be fixed,
it will be mounted read-only, in order to not further damage it.

You can set a filesystem label using the cli command "plabel" or using the
administering  web pages (not for NTFS, at least until you install the
ntfsprogs package).
Ext2/3/4/VFAT/NTFS/ISO9660 filesystems are recognized.

RAID-0,1 and 5 (using an external USB disk) and linear RAID (JBD) are recognized,
assembled and mounted when a disk is inserted or detected.

The leds will be steady orange when a RAID device is degraded, and will
flash in  orange during resync or rebuild. In the status web page you can see
the expected time for completion.

When mounting filesystems, Alt-F will look for a directory called "ffp"
in the filesystem root, and if found a link is created to it at the
root, /. Using the "Package Manager" web page you can install, update or
remove ffp packages.

If a directory name "Users" is found, will be linked to /home.

Alt-F also looks for a directory called Alt-F. If found it will be
aufs-mounted on top of root, "/", shadowing it. This means that any files
(including executables) existing there will be used instead. This is
likely to change, and poses some pathological problems, so don't use it.
Mostly DON'T change or add nothing in that directory, or the box
might crash.
 
USB attached printers will also be recognized, and a rudimentary lpd
spooler used for them. They can also be used with samba.

Disks will, by default, be set to sleep after 20 minuts of inactivity;
when this happens, the corresponding orange led will slowly flash.

If you keep the box front button pressed for more than 3 seconds, the
right led will start flashing, and if you release the button while it is
flashing an ordered reboot will be done; if keep pressed by three more
seconds, the left led will start flashing, and if the button is then
released, the box will do an ordered shutdown.

The reboot and power-down procedures cleanly stop all processes, unmount
filesystems, and stop raid devices.
Internal or external disks can be hot-removed after being "ejected"
using the "eject" command or the "Disk utils" web page.

Please note that RAID hot-plugging is not yet fully functional; when
devices are inserted, it works fine, they are incrementally assembled
and filesystems are mounted, but if some device is removed and then
reinserted, hot-plugging might not work properly.

Also notice that because the arrays are incrementaly added and mounted
as soon as possible, they must have the "intent bitmap" active,
otherwise a rsync happens when the second (on raid-1) or third (on
raid-5) device is inserted. This is work in progress.

}}}
