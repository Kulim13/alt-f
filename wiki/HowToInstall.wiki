#summary How to install

{{{

How to install:
===============

1-If you don't have ffp or a fun_plug file in your box root directory,
  and you don't then even know what that means,
  just download "Alt-F-<version>.tar" and "fun_plug" into your box root
  directory, make sure that "fun_plug" has execution permission and reboot.
  This will only work for one reboot; if you want to try again, you must
  set the execution permissions of fun_plug again.
  This is deliberate, you can override it by editing fun_plug and commenting
  the line on top that says ONCE. Without this, if something goes wrong,
  then your box would reboot endlessly!

2-If you have a fun_plug file, but don't have ffp, than save your current
  fun_plug file, and proceed as in 1 above. 
  You can latter recover your fun_plug file.

3-If you have ffp,
  3-a) Just want to try Alt-F once:
    download Alt-F-<version>.tar and fun_plug, rename run_plug to, e.g,
    alt-f.sh, put them in your box root directory, and call alt-f.sh from
    the shell.
    Your ffp directory, if found in the root directory, will be recognized
    and used by Alt-F. The ffp init script will be executed by Alt-F on boot,
    but you should disable all non needed ffp init scripts, and only keep
    those that provide services that Alt-F don't have.
    Alt-F binaries have precedence over ffp ones.

  3-b) You want to always use it:
    Proceed and in 2), but read 3-a) above.

4-You want to replace the stock firmware, flashing Alt-F on the box:
  You must first follow one of the above steps and be already running Alt-F.
  Download Alt-F-<version>.bin and use the Alt-F firmware upgrade web page to
  flash it. You can't flash Alt-F with the vendor firmware. This is deliberate.
  Alt-F firmware upgrade web page can flash the vendor supplied firmware, so
  you can always do a "downgrade". DLink 1.07 and 1.08, as well as Conceptronic
  1.05b5 firmware was flashed this way *** ON A REV-B1 BOARD ***
  OF COURSE THIS IS DANGEROUS, AND CAN TURN YOUR BOX INTO AN EXPENSIVE BLACK
  BRICK IN YOUR DESKTOP. YOU HAVE BEEN WARNED.

Installation Details
====================

Installing Alt-F using one of the steps outlined in 1, 2 or 3 above, is
a two step process.

1-First, the fun_plug script runs, terminating a set of well know
  processes in order to make enough free memory available for the second
  step; during this first step a log file named alt-f-reloaded.sh is
  created, and you can find it in the root directory of your box disk.

2-The second step is itself a two phase process:
  a) First, a new kernel and root filesystem is loaded into RAM and the
     kernel starts running; this phase is where things most often might fail,
     and there is no possibility of watching or logging what is going on
     (unless you have setup a serial port on your box).

  b) If the kernel boots fine, it tries to run a set of files that
     actually starts Alt-F. At the end of this phase a log file named
     alt-f.log is created on the root directory of your box, and Alt-F
     process starts running.

Diagnosing Installation Problems
================================

0-If you can't access Alt-F web home page, before pulling the power cord
  you can try to see if it is running by pressing and *keep* pressing the
  power button.

  If Alt-F is running, after three seconds the right led start flashing,
  and then the left led. So, Alt-F is running, but you can't communicate
  with it -- there are network problems, see 3) below.

  You can reboot the box by releasing the power button while the right led
  is flashing, or power it off if releasing the power button when the left
  led is flashing.

If the above does not work, you have to restart the box by pulling the
power cord and reboot the box, which returns to the vendor's software.
Then:

1-If you don't find a file called alt-f-reloaded.log in your box disk
  root directory, download everything again and restart -- the fun_plug
  script didn't run OK (step 1 in the Installation Details above)

2-If you find the alt-f-reloaded.log file, but not a alt-f.sh file, then
  Alt-F didn't boot (step 2-b) in the Installation Details above).
  Read the file, look for obvious errors and try to correct them; if
  asking for help, post the file contents.
  One of the more common problems during the 1-b) step in the Installation
  Details above is lack of free memory. If you are using ffp, run Alt-F
  right after rebooting your box.

3-If you find the alt-f.sh file, then step 2-b) in the Installation
  Details above has run OK, and there must exists some other problem.
  Examine the file to see if there are any obvious errors, and post it
  when asking for help.

  The most common problem here are network problems. Remember, you can
  only communicate with Alt-F if the box is connected to a gigabit
  switch/router or computer network card. 

  If your box is using DHCP, assign it a static IP instead, using the
  vendor's web page. The fun_plug script makes Alt-F use the IP the box is
  using at the moment it runs, but at Alt-F boot time it might be in use
  by another computer, or the router might ignore communications with a
  device using a IP not assigned by it.

  You can also try to ping, telnet, ssh or ftp the box, post the results.

  As a last-resort, you can try to comment, in the fun_plug file, the line
  that says "KIP=yes". Use a unix-compatible editor, like notpad++.
  Discovering the IP used by Alt-F in this case can be difficult, read the
  HowToUse wiki.

The reloading process
=====================

By default, when booting, the DNS-323 will search for a file named fun_plug in the
hard disk users directory, usually Volume_1; if it finds it and the file has
the executable attribute set, it will be executed. Thanks D-Link!

When executed (read the fun_plug file, its readable, but DON'T CHANGE OR SAVE IT),
the Alt-F fun_plug script will look for a file named Alt-F-<version>.tar and will
extract it to a directory named alt-f; it will then try to terminate all running 
processes, unmount (or set as read-only) all filesystems, and load and run a new
kernel and filesystem image, the zImage and rootfs.arm.cpio* files).
This critical process is done using fonz "reloaded" kernel modules,
read http://wiki.dns323.info/howto:ffp-reloaded http://www.inreto.de/dns323/ or
http://forum.dsmg600.info/viewforum.php?id=3 for more details.

So,after rebooting, the Alt-F-<version>.tar file will disappear and a new directory
name alt-f will appear.

Uninstalling
============

If you want to uninstall Alt-F, just remove that directory and the fun_plug file.
If you have flashed Alt-F, you can revert the process by downloading a vendor firmware
image and flashing it using Alt-F firmware upgrade web page.

Credits
=======

The reloaded*.ko modules are from fonz ffp-reloaded-0.5-2,
http://www.inreto.de/dns323/ffp-reloaded/packages/ffp-reloaded-0.5-2.tgz

}}}
